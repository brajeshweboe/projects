<?xml version="1.0" encoding="UTF-8"?>
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns="http://ofbiz.apache.org/Widget-Screen"
	xsi:schemaLocation="http://ofbiz.apache.org/Widget-Screen http://ofbiz.apache.org/dtds/widget-screen.xsd">

	<screen name="main">
		<section>
			<actions>
				<set field="headerItem" value="main" /><!-- this highlights the selected 
					menu-item with name "main" -->
			</actions>
			<widgets>
				<decorator-screen name="GaadizoCommonDecorator"
					location="${parameters.mainDecoratorLocation}">
					<decorator-section name="body">
						<platform-specific>
							<html>
								<html-template location="component://gaadizo/template/index.ftl" />
							</html>
						</platform-specific>
					</decorator-section>
				</decorator-screen>
			</widgets>
		</section>
	</screen>
	<screen name="ListGlAccounts">
		<section>
			<actions>
				<set field="titleProperty" value="PageTitleListAccounts" />
				<set field="labelTitleProperty" value="PageTitleListAccounts" />
				<set field="tabButtonItem" value="Chartofaccounts" />
				<!-- no longer works requies a fieldMap entity-and entity-name="GlAccount" 
					list="entityList" use-cache="true" > <limit-range start="0" size="20"/> </entity-and -->
				<set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"
					default-value="0" />
				<property-to-field resource="widget"
					property="widget.form.defaultViewSize" field="viewSizeDefaultValue" />
				<set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer"
					default-value="${viewSizeDefaultValue}" />
				<set field="entityName" value="GlAccount" />
				<set field="noConditionFind" value="Y" />
				<entity-condition entity-name="GlAccount" list="glAccounts"
					use-cache="true">
					<order-by field-name="accountCode" />
				</entity-condition>
				<property-to-field field="defaultCurrencyUomId"
					resource="general" property="currency.uom.id.default" default="USD" />
			</actions>
			<widgets>
				<decorator-screen name="GaadizoCommonDecorator"
					location="${parameters.mainDecoratorLocation}">
					<decorator-section name="body">

						<screenlet title="${uiLabelMap[labelTitleProperty]}">
							<container style="button-bar">
								<link target="ListGlAccountsReport" target-window="_blank"
									text="${uiLabelMap.CommonPrint}" style="buttontext" />
								<link target="ListGlAccountsExport" target-window="_blank"
									text="${uiLabelMap.CommonExport}" style="buttontext" />
							</container>
							<!-- include-form name="ListGlAccount" location="component://accounting/widget/GlobalGlAccountsForms.xml"/ -->
							<platform-specific>
								<html>
									<html-template
										location="component://gaadizo/template/accounting/financeManagement/ChartOfAccounts.ftl" />
								</html>
							</platform-specific>
						</screenlet>
					</decorator-section>
				</decorator-screen>
			</widgets>
		</section>
	</screen>

	<screen name="GlAccountNavigate">
		<section>
			<actions>
				<set field="titleProperty" value="AcctgNavigateAccts" />
				<set field="tabButtonItem" value="Chartofaccounts" />
				<set field="tabButtonItem2" value="GlAccountNavigate" />
				<set field="labelTitleProperty" value="AcctgNavigateAccts" />
				<!-- parameters includes requestAttributes and parameter map -->
				<!-- requestParameters is just the parameter map -->
				<set field="glAccountId" from-field="requestParameters.glAccountId" />
				<set field="trail" from-field="requestParameters.trail" />

				<entity-one entity-name="GlAccount" value-field="glAccount" />
			</actions>
			<widgets>
				<decorator-screen name="GaadizoCommonDecorator"
					location="${parameters.mainDecoratorLocation}">
					<decorator-section name="body">
						<include-menu name="GlSettingTabBar"
							location="component://accounting/widget/AccountingMenus.xml" />
						<screenlet title="${uiLabelMap.AcctgNavigateAccts}">
							<include-tree name="GlAccountTree"
								location="component://accounting/widget/AccountingTrees.xml" />
						</screenlet>
						<screenlet title="${uiLabelMap.PageTitleEditGlAccount}">
							<include-form name="EditGlAccount"
								location="component://accounting/widget/GlobalGlAccountsForms.xml" />
						</screenlet>
					</decorator-section>
				</decorator-screen>
			</widgets>
		</section>
	</screen>

	<!-- the next two screens list out the AcctgTransEntries, either from a 
		GL Account or from an acctgTrans -->
	<screen name="ListGlAccountEntries">
		<section>
			<actions>
				<set field="titleProperty" value="PageTitleViewGlAccountEntries" />
				<set field="tabButtonItem" value="ListGlAccountOrganization" />
				<set field="glAccountId" from-field="requestParameters.glAccountId" />
				<entity-and entity-name="AcctgTransEntry" list="entries">
					<field-map field-name="glAccountId" />
				</entity-and>
			</actions>
			<widgets>
				<decorator-screen name="GaadizoCommonDecorator"
					location="${parameters.mainDecoratorLocation}">
					<decorator-section name="body">
						<screenlet title="${uiLabelMap.PageTitleViewGlAccountEntries}">
							<include-tree name="ListGlAccountTree"
								location="component://accounting/widget/AccountingTrees.xml" />
						</screenlet>
						<screenlet title="${uiLabelMap.PageTitleViewGlAccountEntries}">
							<include-form name="ListAcctgTransEntries"
								location="component://accounting/widget/GlobalGlAccountsForms.xml" />
						</screenlet>
					</decorator-section>
				</decorator-screen>
			</widgets>
		</section>
	</screen>
    <screen name="CommonGlSetupDecorator">
        <section>
            <actions>
                <set field="organizationPartyId" value="${groovy:if(parameters.organizationPartyId!=null) return parameters.organizationPartyId else return parameters.get('ApplicationDecorator|organizationPartyId')}"/>
                <set field="tabButtonItemTop" value="Admin"/>
                <entity-one entity-name="PartyNameView" value-field="currentOrganization" auto-field-map="false">
                    <field-map field-name="partyId" value="${groovy:if(parameters.organizationPartyId!=null) return parameters.organizationPartyId else return parameters.get('ApplicationDecorator|organizationPartyId')}"/>
                </entity-one>
            </actions>
            <widgets>
                <decorator-screen name="GaadizoCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu name="PartyAdminTabBar" location="component://accounting/widget/AccountingMenus.xml"/>
                        <section>
                            <condition>
                                <if-compare field="tabButtonItem" operator="equals" value="GlAccountAssignment"/>
                            </condition>
                            <widgets>
                                <include-menu name="PartyAdminAssignTabBar" location="component://accounting/widget/AccountingMenus.xml"/>
                            </widgets>
                        </section>
                        <label style="h1">${labelTitleProperty} ${uiLabelMap.CommonFor}: ${currentOrganization.groupName} [${organizationPartyId}]</label>
                        <decorator-section-include name="body"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
     <screen name="ListGlAccountOrganization">
        <section>
            <actions>
                <property-map resource="AccountingUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="AccountingChartOfAcctsMenu"/>
                <set field="tabButtonItem" value="ListGlAccountOrganization"/>
                <set field="labelTitleProperty" value="${uiLabelMap.AccountingChartOfAcctsMenu}"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonGlSetupDecorator">
                    <decorator-section name="body">
                        <screenlet id="GlAccountOrganizationPanel" title="${uiLabelMap.AccountingChartOfAcctsMenu}" collapsible="true">
                            <include-form name="AssignGlAccount" location="component://accounting/widget/GlSetupForms.xml"/>
                        </screenlet>
                        <link text="${uiLabelMap.AccountingExportAsCsv}" style="button" target="ListGlAccountOrgCsv.csv">
                            <parameter param-name="organizationPartyId"/>
                        </link>
                        <link text="${uiLabelMap.AccountingExportAsPdf}" style="button" target="ListGlAccountOrgPdf.pdf" target-window="_BLANK">
                            <parameter param-name="organizationPartyId"/>
                        </link>
                        <include-form name="ListGlAccountOrganization" location="component://accounting/widget/GlSetupForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section></screen>
</screens>